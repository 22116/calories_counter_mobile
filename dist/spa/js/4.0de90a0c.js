(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"593b":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=this,n=t.$createElement,r=t._self._c||n;return r("q-layout",{directives:[{name:"touch-swipe",rawName:"v-touch-swipe.mouse.right",value:function(){return e.leftDrawerOpen=!0},expression:"() => this.leftDrawerOpen = true",modifiers:{mouse:!0,right:!0}}],attrs:{view:"lHh Lpr lFf"}},[r("q-header",{attrs:{elevated:""}},[r("q-toolbar",[r("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"menu","aria-label":"Menu"},on:{click:function(e){t.leftDrawerOpen=!t.leftDrawerOpen}}}),r("div",{staticClass:"col"}),r("div",{staticClass:"col-auto"},[this.$route.params.date?[t._v("\n          "+t._s(new Date(this.$route.params.date).toDateString())+"\n        ")]:[t._v("\n          "+t._s(t.date.toDateString())+"\n        ")]],2)],1)],1),r("q-drawer",{attrs:{"show-if-above":"",bordered:"","content-class":"sidebar-content"},model:{value:t.leftDrawerOpen,callback:function(e){t.leftDrawerOpen=e},expression:"leftDrawerOpen"}},[r("q-list",[r("q-item-label",{staticClass:"text-grey-8",attrs:{header:""}},[t._v("\n        Navigation menu\n      ")]),t._l(t.essentialLinks,(function(e){return r("essential-link",t._b({key:e.title},"essential-link",e,!1))})),t._l(t.counterLinks,(function(e,n){return r("confirm-slider-left",{key:n,attrs:{question:"Are you sure you want to delete this counter?","left-color":"red"},on:{success:function(){return t.onCounterDeleted(e.counter.id)}},scopedSlots:t._u([{key:"left",fn:function(){return[t._v("\n          Delete\n          "),r("q-icon",{attrs:{name:"delete"}})]},proxy:!0}],null,!0)},[r("essential-link",t._b({directives:[{name:"touch-hold",rawName:"v-touch-hold:600.mouse",value:function(){return t.onCounterLinkHold(e.counter.id)},expression:"() => onCounterLinkHold(link.counter.id)",arg:"600",modifiers:{mouse:!0}}]},"essential-link",e,!1),[r("q-item-label",{staticClass:"calendar",attrs:{slot:"pre"},slot:"pre"},t._l(e.counter.timeouts,(function(e,n){return r("q-badge",{key:n,attrs:{color:n%2?"info":"primary"}},[t._v("\n              "+t._s(t.getTimeoutListShort(e))+"\n            ")])})),1)],1)],1)})),r("q-item",[r("q-item-section",[r("create-counter",{key:t.counterLinks.length,on:{success:t.counterCreated}})],1)],1),r("q-item",{staticClass:"tip"},[r("q-item-section",{staticClass:"text-center text-grey"},[t._v("\n          Swipe right to delete\n        ")])],1),r("q-item",{staticClass:"tip"},[r("q-item-section",{staticClass:"text-center text-grey"},[t._v("\n          Hold to edit\n        ")])],1)],2)],1),r("q-page-container",{staticClass:"overflow-hidden-x items-stretch"},[r("router-view",{key:t.$route.fullPath,staticClass:"full-width"})],1),null!==t.counter?r("edit-counter",{attrs:{counter:t.counter},on:{success:t.onCounterEdited,cancel:function(){return t.counter=null}}}):t._e()],1)},o=[],i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-item",{attrs:{clickable:"",to:e.link}},[e.icon?n("q-item-section",{attrs:{avatar:""}},[n("q-icon",{attrs:{name:e.icon}})],1):e._e(),n("q-item-section",[e._t("pre"),n("q-item-label",[e._v(e._s(e.title))]),n("q-item-label",{attrs:{caption:""}},[e._v("\n      "+e._s(e.caption)+"\n    ")])],2),n("q-item-section",{attrs:{side:""}},[e._t("default")],2)],1)},s=[],c=n("1b40"),a=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};let l=class extends c["g"]{};a([Object(c["c"])({type:String,required:!0})],l.prototype,"title",void 0),a([Object(c["c"])({type:String,default:""})],l.prototype,"caption",void 0),a([Object(c["c"])({type:String,required:!0})],l.prototype,"link",void 0),a([Object(c["c"])({type:String,default:""})],l.prototype,"icon",void 0),l=a([c["a"]],l);var u=l,d=u,f=n("2877"),p=n("66e5"),h=n("4074"),y=n("0016"),v=n("0170"),m=n("eebe"),b=n.n(m),w=Object(f["a"])(d,i,s,!1,null,null,null),g=w.exports;b()(w,"components",{QItem:p["a"],QItemSection:h["a"],QIcon:y["a"],QItemLabel:v["a"]});var k=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-btn",{attrs:{label:"Create counter",color:"primary","icon-right":"add_task"},on:{click:function(t){e.prompt=!0}}},[n("state-counter",{attrs:{title:"Which counter you would like to create?",show:e.prompt},on:{success:function(t){return e.$emit("success",e.counter)},"update:show":function(t){return e.prompt=t}},model:{value:e.counter,callback:function(t){e.counter=t},expression:"counter"}})],1)},O=[],C=n("b369"),_=n("26a4"),q=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};let j=class extends c["g"]{constructor(){super(),this.prompt=!1,this.counter=this.$container.resolve(_["a"]).create()}};j=q([Object(c["a"])({components:{StateCounter:C["a"]}})],j);var S=j,x=S,$=n("9c40"),D=Object(f["a"])(x,k,O,!1,null,null,null),L=D.exports;b()(D,"components",{QBtn:$["a"]});var Q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("state-counter",{attrs:{title:"Edit counter",show:!0},on:{success:function(t){return e.$emit("success",t)},cancel:function(t){return e.$emit("cancel",t)}},model:{value:e.counter,callback:function(t){e.counter=t},expression:"counter"}})},R=[],P=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};let I=class extends c["g"]{};P([Object(c["c"])({type:Object,required:!0})],I.prototype,"counter",void 0),I=P([Object(c["a"])({components:{StateCounter:C["a"]}})],I);var E=I,T=E,H=Object(f["a"])(T,Q,R,!1,null,null,null),N=H.exports,U=n("0467"),A=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("q-slide-item",e._b({on:{left:e.onSwipe},scopedSlots:e._u([e._l(Object.keys(e.$scopedSlots),(function(t){return{key:t,fn:function(n){return[e._t(t,null,null,n)]}}}))],null,!0)},"q-slide-item",Object.assign(e.$props,e.$attrs),!1),[e._l(Object.keys(e.$slots),(function(t){return e._t(t,null,{slot:t})}))],2),n("confirm",{attrs:{question:e.question},on:{success:function(t){return e.$emit("success")},finished:function(){return e.resetCallback()}},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}})],1)},M=[],B=n("aa29"),F=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};let W=class extends c["g"]{constructor(){super(...arguments),this.show=!1}onSwipe(e){this.resetCallback=e.reset,this.show=!0}};F([Object(c["c"])({type:String,required:!0})],W.prototype,"question",void 0),W=F([Object(c["a"])({components:{Confirm:B["a"]}})],W);var J=W,Y=J,z=n("de1d"),G=Object(f["a"])(Y,A,M,!1,null,null,null),K=G.exports;b()(G,"components",{QSlideItem:z["a"]});var V=[{title:"History",caption:"Check by day",icon:"calendar_today",link:"/history"},{title:"Settings",caption:"Change application preferences",icon:"settings",link:"/settings"},{title:"Statistics",caption:"Explore your results",icon:"analytics",link:"/statistics"}],X=n("3b60"),Z=n("ee3c"),ee=n("6cd4"),te=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},ne=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function s(e){try{a(r.next(e))}catch(t){i(t)}}function c(e){try{a(r["throw"](e))}catch(t){i(t)}}function a(e){e.done?n(e.value):o(e.value).then(s,c)}a((r=r.apply(e,t||[])).next())}))};let re=class extends c["g"]{constructor(){super(...arguments),this.leftDrawerOpen=!1,this.essentialLinks=V,this.counterLinks=[],this.counters=[],this.counter=null,this.hash="",this.date=new Date,this.timer=0}mounted(){return ne(this,void 0,void 0,(function*(){yield this.loadUserCounters(),this.timer=window.setInterval((()=>{this.date=new Date,this.loadUserCounters()}),500)}))}counterCreated(e){return ne(this,void 0,void 0,(function*(){yield this.$container.resolve(X["a"]).dispatch(new Z["a"](e)).then((()=>this.loadUserCounters()))}))}onCounterDeleted(e){return ne(this,void 0,void 0,(function*(){const t=this.counters.find((t=>t.id===e));t?yield this.$container.resolve(X["a"]).dispatch(new Z["c"](t)).then((()=>this.loadUserCounters())):console.error("No counter to delete found")}))}onCounterEdited(e){return ne(this,void 0,void 0,(function*(){yield this.$container.resolve(X["a"]).dispatchAll(new Z["e"](e),new Z["g"](e,new Date)).then((()=>this.loadUserCounters())).then((()=>this.counter=null)).then((()=>this.$router.push("/").catch((()=>console.log("Already on /history")))))}))}onCounterLinkHold(e){return ne(this,void 0,void 0,(function*(){this.hash=e,this.counter=yield this.$orm.repository.counter.find(e)}))}loadUserCounters(){return ne(this,void 0,void 0,(function*(){this.counters=yield this.$orm.repository.counter.setProxy(new ee["a"]).findAll();const e=[];for(const t of this.counters)t.enabled&&e.push(yield this.createCounterLink(t,this.date));this.counterLinks=e.filter((e=>void 0!==e))}))}createCounterLink(e,t){return ne(this,void 0,void 0,(function*(){const n=yield this.$orm.repository.history.setProxy(new ee["a"](e.id+t.toISOString())).findByDateAndCounter(t,e),r=this.$container.resolve(_["a"]).isSucceed(n?n.getCounter():e);return{title:e.name,caption:e.description,icon:e.icon,link:`/counter/${t.toISOString()}/${e.id}`,class:{"bg-green-transparent":r,"bg-red-transparent":!r},counter:e}}))}getTimeoutListShort(e){switch(e){case U["c"].Monday:return"MN";case U["c"].Tuesday:return"TU";case U["c"].Wednesday:return"WN";case U["c"].Thursday:return"TH";case U["c"].Friday:return"FR";case U["c"].Saturday:return"SAT";case U["c"].Sunday:return"SN";case U["c"].Monthly:return"Monthly";case U["c"].Yearly:return"Yearly"}}beforeDestroy(){clearInterval(this.timer)}};re=te([Object(c["a"])({components:{ConfirmSliderLeft:K,EditCounter:N,CreateCounter:L,EssentialLink:g}})],re);var oe=re,ie=oe,se=(n("a5d3"),n("4d5a")),ce=n("e359"),ae=n("65c6"),le=n("9404"),ue=n("1c1c"),de=n("58a81"),fe=n("09e3"),pe=n("12c5"),he=n("f449"),ye=Object(f["a"])(ie,r,o,!1,null,null,null);t["default"]=ye.exports;b()(ye,"components",{QLayout:se["a"],QHeader:ce["a"],QToolbar:ae["a"],QBtn:$["a"],QDrawer:le["a"],QList:ue["a"],QItemLabel:v["a"],QBadge:de["a"],QIcon:y["a"],QItem:p["a"],QItemSection:h["a"],QPageContainer:fe["a"]}),b()(ye,"directives",{TouchSwipe:pe["a"],TouchHold:he["a"]})},a5d3:function(e,t,n){"use strict";n("d80d")},d80d:function(e,t,n){}}]);